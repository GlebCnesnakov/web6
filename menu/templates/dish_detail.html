{% extends "base.html" %}
{% load static %}
{% block title %}
–û –±–ª—é–¥–µ
{% endblock %}
{% block content %}

    <div class="dish-container">
        <h1 class="comments-header">–ë–ª—é–¥–æ: {{ dish.name|capfirst }}</h1>
        
        <div class="dish-photo">
            <img src="{% static dish.photo %}" alt="–§–æ—Ç–æ –±–ª—é–¥–∞">
        </div>
        <div class="dish-more-container">
        <div class="dish-detail">
            <p class="dish_detail_category"><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> {{ dish.category.name }}</p>
        </div>
        
        <div class="dish-detail">
            <p class="dish_detail_category"><strong>–¢–µ–≥–∏:</strong></p>
            <ul class="dish-tags">
                {% for p in dish.tags.all %}
                    <li>{{ p.name }}</li>
                {% empty %}
                    <li>–ù–µ—Ç —Ç–µ–≥–æ–≤</li>
                {% endfor %}
            </ul>
        </div>
        
        <div class="dish-detail">
            <p class="dish_detail_price"><strong>–¶–µ–Ω–∞:</strong> {{ dish.price }}</p>
        </div>
        </div>
        <div class="dish-detail">
    <p><strong>–û—Ü–µ–Ω–∏—Ç–µ –±–ª—é–¥–æ:</strong></p>
    <p>üëç {{ likes }} | üëé {{ dislikes }}</p>

    {% if user.is_authenticated %}
        <form method="post" style="display: inline;">
            {% csrf_token %}
            <input type="hidden" name="reaction" value="like">
            <button type="submit" {% if user_reaction and user_reaction.type == 'like' %}disabled{% endif %}>üëç –õ–∞–π–∫</button>
        </form>

        <form method="post" style="display: inline;">
            {% csrf_token %}
            <input type="hidden" name="reaction" value="dislike">
            <button type="submit" {% if user_reaction and user_reaction.type == 'dislike' %}disabled{% endif %}>üëé –î–∏–∑–ª–∞–π–∫</button>
        </form>
    {% else %}
        <p><a href="{% url 'users:login' %}?next={{ request.path }}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –æ—Ü–µ–Ω–∏—Ç—å –±–ª—é–¥–æ.</p>
    {% endif %}
</div>

<hr>

<div class="dish-detail">
    <h2>–û—Ç–∑—ã–≤—ã:</h2>

    {% if user.is_authenticated %}
        <form method="post">
            {% csrf_token %}
            <textarea name="text" rows="3" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –æ—Ç–∑—ã–≤..." required>{{ form.text.value }}</textarea>
            <button type="submit" name="review">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
        </form>
    {% else %}
        <p><a href="{% url 'users:login' %}?next={{ request.path }}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤.</p>
    {% endif %}

    <div>
        {% for review in reviews %}
            <p>
                <strong>{{ review.user.username }}</strong> ({{ review.date|date:"d.m.Y H:i" }}):<br>
                {{ review.text }}
            </p>
        {% empty %}
            <p>–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤.</p>
        {% endfor %}
        </div>
    </div>
    </div>

{% endblock %}
